# Migration `20200817102148-init`

This migration has been generated by Sopanat at 8/17/2020, 5:21:48 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "dev"."Account" (
"id" text  NOT NULL ,
"studentId" text   ,
"studentFirstName" text  NOT NULL ,
"studentLastName" text  NOT NULL ,
"studentEmail" text  NOT NULL ,
"studentPassword" text   ,
"isActivate" boolean  NOT NULL DEFAULT false,
"userLevel" "userLevel" NOT NULL ,
"lastLogin" timestamp(3)   ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id"))

CREATE TABLE "dev"."AccountInfo" (
"id" text  NOT NULL ,
"accountId" text  NOT NULL ,
"nickname" text   ,
"educateGroup" integer  NOT NULL ,
"graduateSchool" text   ,
"admissionYear" integer   ,
"profileImageUrl" text   ,
"canContactAddress" text   ,
"currentAddress" text   ,
"workAddress" text   ,
"phoneNumber" text   ,
"facebookAccount" text   ,
"lineID" text   ,
"privacyPermission" boolean  NOT NULL DEFAULT true,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id"))

CREATE TABLE "dev"."StudentActivity" (
"id" text  NOT NULL ,
"accountId" text   ,
"studentId" text   ,
"activityAllCount" integer  NOT NULL ,
"activityJoinedCount" integer  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id"))

CREATE TABLE "dev"."StudentGrade" (
"id" text  NOT NULL ,
"StudentId" text  NOT NULL ,
"totalCredit" Decimal(65,30)   ,
"totalAverageGrade" Decimal(65,30)   ,
"totalMainSubjectGrade" Decimal(65,30)   ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"accountId" text   ,
PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "Account.studentId_unique" ON "dev"."Account"("studentId")

CREATE UNIQUE INDEX "Account.studentEmail_unique" ON "dev"."Account"("studentEmail")

CREATE UNIQUE INDEX "AccountInfo.accountId_unique" ON "dev"."AccountInfo"("accountId")

CREATE UNIQUE INDEX "StudentActivity.accountId_unique" ON "dev"."StudentActivity"("accountId")

CREATE UNIQUE INDEX "StudentGrade.accountId_unique" ON "dev"."StudentGrade"("accountId")

ALTER TABLE "dev"."AccountInfo" ADD FOREIGN KEY ("accountId")REFERENCES "dev"."Account"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "dev"."StudentActivity" ADD FOREIGN KEY ("accountId")REFERENCES "dev"."Account"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "dev"."StudentGrade" ADD FOREIGN KEY ("accountId")REFERENCES "dev"."Account"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200817102148-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,72 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model Account {
+  id               String            @id @default(uuid())
+  studentId        String?           @unique
+  studentFirstName String
+  studentLastName  String
+  studentEmail     String            @unique
+  studentPassword  String?
+  isActivate       Boolean           @default(false)
+  userLevel        userLevel
+  lastLogin        DateTime?
+  createdAt        DateTime          @default(now())
+  updatedAt        DateTime          @default(now())
+  AccountInfo      AccountInfo[]
+  StudentActivity  StudentActivity[]
+  StudentGrade     StudentGrade[]
+}
+
+model AccountInfo {
+  id                String   @id @default(cuid())
+  accountId         String   @unique
+  nickname          String?
+  educateGroup      Int
+  graduateSchool    String?
+  admissionYear     Int?
+  profileImageUrl   String?
+  canContactAddress String?
+  currentAddress    String?
+  workAddress       String?
+  phoneNumber       String?
+  facebookAccount   String?
+  lineID            String?
+  privacyPermission Boolean  @default(true)
+  createdAt         DateTime @default(now())
+  updatedAt         DateTime @default(now())
+  Account           Account  @relation(fields: [accountId], references: [id])
+}
+
+model StudentActivity {
+  id                  String   @id @default(cuid())
+  accountId           String?  @unique
+  studentId           String?
+  activityAllCount    Int
+  activityJoinedCount Int
+  createdAt           DateTime @default(now())
+  Account             Account? @relation(fields: [accountId], references: [id])
+}
+
+model StudentGrade {
+  id                    String   @id @default(cuid())
+  StudentId             String
+  totalCredit           Float?
+  totalAverageGrade     Float?
+  totalMainSubjectGrade Float?
+  createdAt             DateTime @default(now())
+  accountId             String?  @unique
+  Account               Account? @relation(fields: [accountId], references: [id])
+}
+
+enum userLevel {
+  ADMIN
+  STUDENT
+  TEACHER
+}
```


